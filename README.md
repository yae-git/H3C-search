# 网闸ACL实时搜索工具

## 项目简介

网闸ACL实时搜索工具是一个基于Python和Tkinter开发的GUI应用，用于连接网闸设备并实时搜索、查看和导出ACL（访问控制列表）数据。

## 功能特性

- **网闸地址配置**：支持自定义网闸IP/域名和端口
- **Cookie登录**：通过导入Cookie实现快速登录
- **ACL数据加载**：实时从网闸获取ACL数据
- **多条件搜索**：支持按名称、客户端地址、目的地址等字段搜索
- **数据导出**：支持将ACL数据导出为Excel文件
- **新增字段**：包含客户端掩码和目的地址掩码列
- **用户友好界面**：直观的图形界面，操作简单

## 安装方法

### 从源码运行

1. 确保已安装Python 3.7+
2. 安装依赖包：
   ```bash
   pip install requests pandas openpyxl tkinter
   ```
3. 运行脚本：
   ```bash
   python search.py
   ```

## 使用说明

### 1. 配置网闸地址

- 启动工具后，首先会弹出网闸地址配置窗口
- 输入网闸的IP/域名和端口（默认443）
- 点击"确认配置"按钮

### 2. Cookie登录

- 在登录窗口中，输入从浏览器复制的Cookie
- Cookie格式：`JSESSIONID=xxx; other=xxx`
- 点击"Cookie登录"按钮
- 也可以先点击"测试连接"按钮检查网闸是否可达

### 3. 查看ACL数据

- 登录成功后，工具会自动加载ACL数据
- 数据会显示在表格中，包含序号、名称、所属端机、控制模式、监控网卡、协议类型、动作、客户端地址、客户端掩码、客户端端口段、目的地址、目的地址掩码、目的端口段、启停按钮等字段

### 4. 搜索功能

- 在搜索区域选择搜索字段（名称、客户端地址、目的地址、所属端机、协议类型）
- 输入关键词
- 选择匹配模式（模糊匹配或精确匹配）
- 点击"搜索"按钮

### 5. 导出数据

- 点击顶部栏的"导出数据"按钮
- 数据会导出为Excel文件，文件名为 `acl_data_时间戳.xlsx`
- 导出文件保存在工具所在目录

## 常见问题

### 1. 登录失败

- 检查Cookie是否正确，确保是从已登录的浏览器中复制的
- 检查网络连接是否正常
- 检查网闸IP和端口是否正确

### 2. 数据加载失败

- 检查Cookie是否有效
- 检查网闸是否正常运行
- 检查网络连接是否稳定

### 3. 导出失败

- 确保安装了openpyxl库：`pip install openpyxl`
- 检查磁盘空间是否充足
- 检查文件权限是否正常

## 注意事项

- 本工具仅用于合法的网络管理和维护工作
- 使用前请确保您有权限访问目标网闸设备
- 导出的数据请妥善保管，避免泄露敏感信息
- 如有问题，请联系系统管理员

## 技术说明

- 开发语言：Python 3.7+
- GUI框架：Tkinter
- 网络请求：requests
- 数据处理：pandas
- 导出功能：openpyxl


---

**免责声明**：本工具仅供参考和学习使用，使用本工具产生的一切后果由使用者自行承担。
